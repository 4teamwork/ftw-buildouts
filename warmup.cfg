[buildout]
parts +=
    make-warmup-config-file
    warmup

instance-eggs += collective.warmup



[warmup-configuration]
mountpoint = ${buildout:filestorage-parts}
site-id = platform
base_path = ${warmup-configuration:mountpoint}/${warmup-configuration:site-id}

urls =
    siteroot

url-sections =
    [siteroot]
    path = ${warmup-configuration:base_path}/
    follow_links = True



[instance0]
environment-vars +=
    WARMUP_BIN ${buildout:directory}/bin/warmup
    WARMUP_INI ${make-warmup-config-file:output}



[make-warmup-config-file]
recipe = collective.recipe.template
output = ${buildout:parts-directory}/warmup/warmup.ini
input = inline:
    [warmup]
    enabled = True
    sleep = 4
    base_url = http://localhost
    logfile = ${buildout:directory}/var/log/warmup.log
    urls = ${warmup-configuration:urls}

    ${warmup-configuration:url-sections}



[warmup]
recipe = zc.recipe.egg:scripts
eggs = collective.warmup
dependent-scripts = false
